
name: Build Tauri App
on:
  push:
    branches: [ main ]

jobs:
  build-windows:
    runs-on: windows-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Setup Rust
        uses: dtolnay/rust-toolchain@stable
        
      - name: Install Tauri CLI v1
        run: cargo install tauri-cli --version ^1.5
        
      - name: Create tauri.conf.json
        run: |
          echo '{ "build": { "devPath": "../public", "distDir": "../public", "withGlobalTauri": true }, "package": { "productName": "Password Bunker", "version": "1.0.0" }, "tauri": { "bundle": { "identifier": "com.passwordbunker.usb", "targets": ["msi"] }, "allowlist": { "clipboard": { "all": true }, "fs": { "writeFile": true, "readFile": true }, "path": { "all": true } }, "windows": [{ "title": "Password Bunker USB", "width": 750, "height": 650, "resizable": false }] } }' > tauri.conf.json
        
      - name: Build
        run: cargo tauri build
        
      - name: Upload EXE
        uses: actions/upload-artifact@v4
        with:
          name: password-bunker-exe
          path: src-tauri/target/release/*.exe
